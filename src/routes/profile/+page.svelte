<script>
// @ts-nocheck

  // mock data ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
  let data = {
    personal: {
      user_type: '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£',
      email: 'user@example.com',
      prefix: '‡∏ô‡∏≤‡∏¢',
      firstname: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢',
      lastname: '‡πÉ‡∏à‡∏î‡∏µ',
      id_number: '1234567890123',
      idcard_file: '',
      birthday: '1990-01-01',
      address: '123 ‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á',
      phone_number: '099-999-9915'
    },
    durian: {
      durian_type: "‡∏´‡∏°‡∏≠‡∏ô‡∏ó‡∏≠‡∏á",
      durian_age: '5',
      tree_count: '20',
      flowering_startdate: "2025-03-15",
      harvest_month: "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô",
      weight_expected: "1500.5"
    },
    farm: {
      location: 'https://www.google.com/maps?q=14.973211,102.08432'
    },
    titledeed: {
      titledeed_num: 'TD-1001',
      titledeed_file: ''
    }
  };

  // üè∑Ô∏è labels ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ü‡∏¥‡∏•‡∏î‡πå
  const labels = {
    personal: {
      user_type: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ',
      prefix: '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤',
      email: '‡∏≠‡∏µ‡πÄ‡∏°‡∏•',
      firstname: '‡∏ä‡∏∑‡πà‡∏≠',
      lastname: '‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•',
      id_number: '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
      idcard_file: '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
      birthday: '‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î',
      address: '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà',
      phone_number: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå'
    },
    durian: {
      durian_type: "‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",
      durian_age: '‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô(‡∏õ‡∏µ)',
      tree_count: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πâ‡∏ô',
      flowering_startdate: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏≠‡∏Å‡∏î‡∏≠‡∏Å",
      harvest_month: "‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
      weight_expected: "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö (‡∏Å‡∏Å.)"
    },
    farm: {
      location: '‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏õ‡∏•‡∏á'
    },
    titledeed: {
      titledeed_num: '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÇ‡∏â‡∏ô‡∏î‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô',
      titledeed_file: '‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö'
    }
  };

  // @ts-ignore
  let editingSection = null;
  let tempData = {};

  // @ts-ignore
  function startEdit(section) {
    editingSection = section;
    tempData = JSON.parse(JSON.stringify(data[section])); // clone
  }


  // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤
  const prefixes = ['‡∏ô‡∏≤‡∏¢', '‡∏ô‡∏≤‡∏á', '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß'];
</script>

  <h1>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h1>

  <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
  <form class="profile">
    <fieldset class="card">
      <legend>
        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
        {#if editingSection === 'personal'}
          <button type="button" on:click>üíæ</button>
          <button type="button" on:click>‚ùå</button>
        {:else}
          <button type="button" on:click={() => startEdit('personal')}>‚úèÔ∏è</button>
        {/if}
      </legend>

      {#each Object.entries(data.personal) as [key, value]}
        <div class="field">
          <!-- svelte-ignore a11y_label_has_associated_control -->
          <label>{labels.personal[key]}</label>

          {#if editingSection === 'personal'}
            {#if key === 'prefix'}
              <select bind:value={tempData[key]}>
                {#each prefixes as p}
                  <option value={p}>{p}</option>
                {/each}
              </select>

            {:else if key === 'birthday'}
              <input type="date" bind:value={tempData[key]} />

            {:else if key === 'idcard_file'}
              <input type="file" on:change={(e) => tempData[key] = e.target.files[0]?.name} />

            {:else}
              <input bind:value={tempData[key]} />
            {/if}
          {:else}
            {#if key === 'idcard_file'}
              {#if value}
                <a href={value} target="_blank">‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå</a>
              {:else}
                <span>-</span>
              {/if}
            {:else}
              <input type="text" value={value} readonly />
            {/if}
          {/if}
        </div>
      {/each}
    </fieldset>
  </form>

  <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
  <form class="profile">
    <fieldset class="card">
      <legend>
        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        {#if editingSection === 'durian'}
          <button type="button" on:click>üíæ</button>
          <button type="button" on:click>‚ùå</button>
        {:else}
          <button type="button" on:click={() => startEdit('durian')}>‚úèÔ∏è</button>
        {/if}
      </legend>

      {#each Object.entries(data.durian) as [key, value]}
        <div class="field">
          <!-- svelte-ignore a11y_label_has_associated_control -->
          <label>{labels.durian[key]}</label>
          {#if editingSection === 'durian'}
            {#if key === 'flowering_startdate'}
              <input type="date" bind:value={tempData[key]} />
            {:else}
              <input bind:value={tempData[key]} />
            {/if}
          {:else}
            <input type="text" value={value} readonly />
          {/if}
        </div>
      {/each}
    </fieldset>
  </form>

    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å -->
    <form class="profile">
      <fieldset class="card">
        <legend>
          ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å
          {#if editingSection === 'farm'}
            <button type="button" on:click>üíæ</button>
            <button type="button" on:click>‚ùå</button>
          {:else}
            <button type="button" on:click={() => startEdit('farm')}>‚úèÔ∏è</button>
          {/if}
        </legend>

        {#each Object.entries(data.farm) as [key, value]}
          <div class="field">
            <!-- svelte-ignore a11y_label_has_associated_control -->
            <label>{labels.farm[key]}</label>

            {#if editingSection === 'farm'}
              <input bind:value={tempData[key]} placeholder="‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå Google Maps" />
            {:else}
              <a href={value} target="_blank" class="map-link">‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</a>
            {/if}
          </div>
        {/each}
      </fieldset>
    </form>


  <!-- ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô -->
  <form class="profile">
    <fieldset class="card">
      <legend>
        ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô
        {#if editingSection === 'landDoc'}
          <button type="button" on:click>üíæ</button>
          <button type="button" on:click>‚ùå</button>
        {:else}
          <button type="button" on:click={() => startEdit('titledeed')}>‚úèÔ∏è</button>
        {/if}
      </legend>

      {#each Object.entries(data.titledeed) as [key, value]}
        <div class="field">
          <!-- svelte-ignore a11y_label_has_associated_control -->
          <label>{labels.titledeed[key]}</label>

          {#if editingSection === 'titledeed'}
            {#if key === 'titledeed_file'}
              <input type="file" on:change={(e) => tempData[key] = e.target.files[0]?.name} />
            {:else}
              <input bind:value={tempData[key]} />
            {/if}
          {:else}
            {#if key === 'titledeed_file'}
              {#if value}
                <a href={value} target="_blank">‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå</a>
              {:else}
                <span>-</span>
              {/if}
            {:else}
              <input type="text" value={value} readonly />
            {/if}
          {/if}
        </div>
      {/each}
    </fieldset>
  </form>


<style>
  .profile {
    font-family: 'Prompt', sans-serif;
    margin: 0 auto;
  }

  h1 {
    color: #010b05;
    margin-bottom: 16px;
  }

  fieldset.card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    padding: 20px;
    margin-bottom: 20px;
    border: none;
  }

  legend {
    font-weight: 700;
    font-size: 1.2rem;
    color: #14532d;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .field {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
  }

  label {
    width: 220px;
    font-weight: 600;
    color: #374151;
  }

  input[readonly] {
    background-color: #f3f4f6;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    padding: 6px;
    flex: 1;
  }

  input, select {
    flex: 1;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    padding: 6px;
  }

  button {
    padding: 6px 10px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
  }

  .map-link {
    color: #2563eb;
    text-decoration: underline;
  }
</style>
